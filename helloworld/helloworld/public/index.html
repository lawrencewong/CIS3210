<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>CIS*3210 Website</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Computer Networking Website">
    <meta name="author" content="Lawrence Wong">

    <!-- CSS Files -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/main.css" rel="stylesheet">
    <link href="css/bootstrap-responsive.min.css" rel="stylesheet">
    <link rel="icon" href="favicon.ico" type="image/x-icon"/>

  </head>
  <body>

    <div id="wrap">

      <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="navbar-inner">
          <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="brand" href="#">CIS*3210 Website</a>
            <div class="nav-collapse collapse">
              <ul class="nav">
                <li class="active"><a href="#">Home</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="container">
        <h2><a href="http://www.restapitutorial.com/" style="color: WHITE;">RESTful API</a> and <a href="http://api.jquery.com/jquery.ajax/" style="color: WHITE;">AJAX</a></h2>
	<h5>This is an web application that uses a RESTful API and jQuery's AJAX to mimic a user managment web application with a database.
	    Play with the user's functions and see what the returns from the server side are. All user functions work. The server side
	    has been set up to mimic a database on one session.
	</h5>
      </div>

      <div class="container">
        <div class="rest-form">
          <div class="row">
            <div class="span6">
              <div>
                <input type="number" min="0" id="userid" placeholder="User ID">
              </div>
              <div>
                <input type="text" id="firstName" placeholder="First Name">
              </div>
              <div>
                <input type="text" id="lastName" placeholder="Last Name">
              </div>
            </div>
            <div class="span6">
              <label for="status-box" class="rest-labels">User Functions:</label>
              <div>
                <button class="btn btn-success btn-small" id="addUser">Add User</button>
                <button class="btn btn-warning btn-small" id="changeName">Edit User</button>
                <button class="btn btn-info btn-small" id="checkUser">User Check</button>
                <button class="btn btn-danger btn-small" id="removeUser">Remove User</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="user-forms">
        <label for="status-box"  class="rest-labels">Status / Returns:</label>
        <textarea readonly id="status-box" placeholder="Status and data that will be returned."></textarea>
      </div>

      <div id="push"></div> <!-- Sticky footer push -->
    </div>

    <div id="footer">
      <div class="container">
        <p class="muted credit">Lawrence Wong 0725315</p>
      </div>
    </div>

    <!-- The javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="./js/jquery-1.11.1.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script type="text/javascript">	

      $('#addUser').on('click', function(event) {
        if($('#firstName').val()=="" || $('#lastName').val()==""){
            $('#status-box').val("First and last names required.");
        }else{
          $.ajax({
            type: "POST",
            url: "/users/addUser",
            data: {firstName:$('#firstName').val(), lastName:$('#lastName').val()}
          })
          .done(function( data ) {
            $('#status-box').val("Added User: " + data);
          });
        }
      });

      $('#changeName').on('click', function(event) {
        if($('#userid').val()=="" || $('#firstName').val()=="" || $('#lastName').val()==""){
          $('#status-box').val("User ID, first and last names required.");
        }else{
          $.ajax({
            type: "PUT",
            url: "/users/changeName/" + $('#userid').val(),
            data: {firstName:$('#firstName').val(), lastName:$('#lastName').val()}
          })
          .done(function( data ) {
            var obj = jQuery.parseJSON( data );
            if( obj.hasOwnProperty('error')){
              $('#status-box').val("ERROR: " + obj.error);
            }else{
              $('#status-box').val("Edited User: " + data);
            }
          });
        }
      });

      $('#checkUser').on('click', function(event) {
        if($('#userid').val()==""){
          $('#status-box').val("User ID required.");
        }else{
          $.ajax({
            type: "GET",
            url: "/users/userCheck/" + $('#userid').val()
          })
          .done(function( data ) {
            var obj = jQuery.parseJSON( data );
            if( obj.hasOwnProperty('error')){
              $('#status-box').val("ERROR: " + obj.error);
            }else{
              $('#status-box').val("Found User: " + data);
            }
          });
        }
      });

      $('#removeUser').on('click', function(event) {
        if($('#userid').val()==""){
            $('#status-box').val("User ID required.");
          }else{
            event.preventDefault();
            if (window.confirm("Are you sure?")) {
              $.ajax({
                type: "DELETE",
                url: "/users/removeUser/" + $('#userid').val()
              })
              .done(function( data ) {
                var obj = jQuery.parseJSON( data );
                if( obj.hasOwnProperty('error')){;
                  $('#status-box').val("ERROR: " + obj.error);
                }else{
                  $('#status-box').val("Removing User: " + data);
                }
              });
            }
          }
      });
    </script>
    </body>
</html>